<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden;">

    <a-scene>
      <a-assets>
        <video id="webcam" autoplay muted playsinline crossorigin="anonymous"></video>
      </a-assets>

      <a-videosphere src="#webcam" rotation="0 -90 0" radius="100"></a-videosphere>

      <a-box position="0 1.5 -3" color="red" animation="property: rotation; to: 0 360 0; loop: true; dur: 5000"></a-box>

      <a-entity camera look-controls></a-entity>
    </a-scene>

    <script>
      const video = document.querySelector('#webcam');

      // 1. Запрашиваем камеру
      navigator.mediaDevices.getUserMedia({ 
        video: { facingMode: 'environment' } 
      })
      .then(stream => {
        video.srcObject = stream;
        video.play();
      })
      .catch(err => {
        console.error("Ошибка:", err);
        alert("Проверь HTTPS и разрешения камеры");
      });

      // 2. Хак для iOS/Android: запуск видео по клику (браузеры часто блокируют автоплей)
      window.addEventListener('click', () => {
        video.play();
      });
    </script>
  </body>
</html>